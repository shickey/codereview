/*!
 * angular-ui-scrollpoint
 * https://github.com/angular-ui/ui-scrollpoint
 * Version: 2.1.1 - 2016-02-22T01:35:08.609Z
 * License: MIT
 */
!function(){"use strict";angular.module("ui.scrollpoint",[]).directive("uiScrollpoint",["$window","$timeout",function(t,e){function i(){if(angular.isDefined(t.pageYOffset))return t.pageYOffset;var e=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;return e.scrollTop}function s(){return t.document.body.scrollHeight-t.innerHeight}function n(e){return e?t.document.body.clientHeight:t.innerHeight}return{require:["uiScrollpoint","^?uiScrollpointTarget"],controller:function(){function o(t){var e={shift:0,absolute:!1,percent:!1};if(t&&angular.isString(t))if(e.percent="%"==t.charAt(t.length-1),e.percent&&(t=t.substr(0,t.length-1)),"-"===t.charAt(0))e.absolute=e.percent,e.shift=-parseFloat(t.substr(1));else if("+"===t.charAt(0))e.absolute=e.percent,e.shift=parseFloat(t.substr(1));else{var i=parseFloat(t);!isNaN(i)&&isFinite(i)&&(e.absolute=!0,e.shift=i)}else if(angular.isNumber(t))return o(t.toString());return e}var r=this;this.$element=void 0,this.$target=void 0,this.hasTarget=!1,this.hit=void 0,this.edges={top:{top:!0}},this.hitEdge=void 0,this.default_edge={absolute:!1,percent:!1,shift:0},this.posCache={},this.ready=!1,this.enabled=!0,this.scrollpointClass="ui-scrollpoint",this.actions=void 0,this.addEdge=function(t,e){if(angular.isString(t))if(angular.isUndefined(e)&&(e=!0),"view"==t)this.addEdge("top","bottom"),this.addEdge("bottom","top");else{var i,s;if(angular.isObject(e))for(i in e)e[i]=e[i]===!0?!0:o(e[i]);else"top"==e||"bottom"==e?(i=e,s=o(),e={},e[i]=s):e===!0?(e={},e[t]=!0):(s=o(e),e={},e[t]=s);this.edges[t]=e}},this.addAction=function(t){t&&angular.isFunction(t)&&(angular.isUndefined(this.actions)?this.actions=[t]:-1==this.actions.indexOf(t)&&this.actions.push(t))},this.setScrollpoint=function(t){this.default_edge=o(t)},this.setClass=function(t){t||(t="ui-scrollpoint"),this.scrollpointClass=t},this.setEdges=function(t){if(angular.isString(t))this.edges={},this.addEdge(t);else if(angular.isArray(t)){this.edges={};for(var e=0;e<t.length;e++)this.addEdge(t[e])}else if(angular.isObject(t)){this.edges={};for(var i in t)this.addEdge(i,t[i])}else this.edges={},this.addEdge("top")},this.setElement=function(t){this.$element=t},this.setTarget=function(e){e?(this.$target=e,this.hasTarget=!0):(this.$target=angular.element(t),this.hasTarget=!1)},this.getEdge=function(t,e){if(t&&e){if(this.edges[t]&&this.edges[t][e]&&this.edges[t][e]!==!0)return this.edges[t][e]}else if(t&&!e){if(this.edges[t])return this.edges[t];return}return this.default_edge},this.checkOffset=function(t,e,i){var s;i||(i=this.default_edge);var n="bottom"==t,o="top"==e,r="bottom"==e,l=this.getScrollOffset();n&&(l+=this.getTargetHeight());var a;return i.absolute?(a=i.percent?i.shift/100*this.getTargetScrollHeight():i.shift,n&&(a=this.getTargetContentHeight()-a,this.hasTarget&&(a+=this.getTargetHeight()))):(o?a=this.getElementTop():r&&(a=this.getElementBottom()),a+=i.shift),s=l-a,n&&(s*=-1),s},this.scrollEdgeHit=function(){var t,e,i,s,n,o,r;i=0,s={};for(o in this.edges)for(r in this.edges[o]){n=this.getEdge(o,r);var l=this.checkOffset(o,r,n);n.absolute?(angular.isUndefined(s)&&(s={}),angular.isUndefined(s[o])&&(s[o]={}),s[o][r]=l,i++):(angular.isUndefined(t)||l>t)&&(t=l,e={scroll:o,element:r})}if(i&&!e){var a=!0;t=void 0;for(o in s)for(r in s[o])i>1&&s[o][r]<0?a=!1:(angular.isUndefined(t)||s[o][r]>t)&&(t=s[o][r],e={scroll:o,element:r});a||(e=void 0,t=void 0)}return this.hitEdge=t>=0?e:void 0,t},this.getScrollOffset=function(){return this.hasTarget?this.$target[0].scrollTop:i()},this.getTargetHeight=function(){return this.hasTarget?this.$target[0].offsetHeight:n()},this.getTargetContentHeight=function(){return this.hasTarget?this.$target[0].scrollHeight-this.$target[0].clientHeight:n(!0)},this.getTargetScrollHeight=function(){return this.hasTarget?this.$target[0].scrollHeight-this.$target[0].clientHeight:s()},this.getElementTop=function(t){if(!t&&angular.isDefined(this.posCache.top))return this.posCache.top;var e=this.$element[0].getBoundingClientRect(),i=e.top+this.getScrollOffset();if(this.hasTarget){var s=this.$target[0].getBoundingClientRect();i-=s.top}return i},this.getElementBottom=function(t){return this.getElementTop(t)+this.$element[0].offsetHeight},this.cachePosition=function(){this.posCache.top=this.getElementTop(!0)},this.onScroll=function(){if(r.ready&&r.enabled){var t=r.scrollEdgeHit(),e=!1;if(t>=0?r.hit||(r.$element.hasClass(r.scrollpointClass)||r.$element.addClass(r.scrollpointClass),e=!0,r.hit=!0):((r.hit||angular.isUndefined(r.hit))&&(r.$element.hasClass(r.scrollpointClass)&&r.$element.removeClass(r.scrollpointClass),e=!0,r.hit=!1),r.cachePosition()),e&&r.actions)for(var i=0;i<r.actions.length;i++)r.actions[i](t,r.$element,r.hitEdge?r.hitEdge.scroll:void 0,r.hitEdge?r.hitEdge.element:void 0)}},this.reset=function(){e(function(){r.$element.removeClass(r.scrollpointClass),r.hit=void 0,r.hitEdge=void 0,r.cachePosition(),r.onScroll()})}},link:function(t,e,i,s){function n(){o.$target.on("scroll",o.onScroll),t.$on("$destroy",function(){o.$target.off("scroll",o.onScroll)})}var o=s[0],r=s[1],l=!1;o.setElement(e),o.setTarget(r?r.$element:null),i.$observe("uiScrollpoint",function(t){o.setScrollpoint(t),o.reset()}),i.$observe("uiScrollpointEnabled",function(e){e=t.$eval(e),e!=o.enabled&&o.reset(),o.enabled=e}),i.$observe("uiScrollpointAbsolute",function(e){e=t.$eval(e),e!=l&&(o.$target&&o.$target.off("scroll",o.onScroll),o.setTarget(!e&&r?r.$element:null),n(),o.reset()),l=e}),i.$observe("uiScrollpointAction",function(e){var i=t.$eval(e);i&&angular.isFunction(i)&&o.addAction(i)}),i.$observe("uiScrollpointClass",function(t){e.removeClass(o.scrollpointClass),o.setClass(t),o.reset()}),i.$observe("uiScrollpointEdge",function(e){if(e){var i=["top","bottom","view"];-1==i.indexOf(e)&&(e=t.$eval(e)),o.setEdges(e),o.reset()}}),n(),e.ready(function(){o.ready=!0,o.onScroll()}),t.$on("scrollpointShouldReset",o.reset)}}}]).directive("uiScrollpointTarget",[function(){return{controller:["$element",function(t){this.$element=t}]}}])}();